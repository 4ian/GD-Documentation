<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>GDevelop Core: About Extension.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="glogo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDevelop Core
   </div>
   <div id="projectbrief">Core library for developing platforms and tools compatible with GDevelop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="overview.html">Overview of GDCore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">About Extension.cpp </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>An extension has to define (usually in a file called <em>Extension.cpp</em> for the C++ Platform or <em>JsExtension.cpp</em> for the JS Platform) a class that is derived from the <a class="el" href="classgd_1_1_platform_extension.html" title="Base class for implementing platform&#39;s extensions. ">gd::PlatformExtension</a> class. This class contains, in its constructor, the declarations of everything that is provided by the extension.</p>
<h1><a class="anchor" id="extensionDeclaration"></a>
Declare the extension information</h1>
<p>The declarations are made using the methods provided by <a class="el" href="classgd_1_1_platform_extension.html" title="Base class for implementing platform&#39;s extensions. ">gd::PlatformExtension</a>.</p>
<p>The first declaration if often the information about the extension:</p>
<div class="fragment"><div class="line">Extension()</div>
<div class="line">{</div>
<div class="line">        SetExtensionInformation(<span class="stringliteral">&quot;TextObject&quot;</span>,</div>
<div class="line">                              _(<span class="stringliteral">&quot;Text object&quot;</span>),</div>
<div class="line">                              _(<span class="stringliteral">&quot;Extension allowing to use an object displaying a text.&quot;</span>),</div>
<div class="line">                              <span class="stringliteral">&quot;Florian Rival&quot;</span>,</div>
<div class="line">                              <span class="stringliteral">&quot;Open Source (MIT License)&quot;</span>);</div>
</div><!-- fragment --><p>The first parameter is the name of the extension. Choose carefully the name of the extension, as projects are directly referring to it.</p>
<h1><a class="anchor" id="instructionsDeclaration"></a>
Declare actions, conditions and expressions</h1>
<p>Actions are declared like this :</p>
<div class="fragment"><div class="line">AddAction(<span class="stringliteral">&quot;ActionName&quot;</span>,</div>
<div class="line">               _(<span class="stringliteral">&quot;Name displayed to users&quot;</span>),</div>
<div class="line">               _(<span class="stringliteral">&quot;Description&quot;</span>),</div>
<div class="line">               _(<span class="stringliteral">&quot;Sentence displayed in event editor&quot;</span>),</div>
<div class="line">               _(<span class="stringliteral">&quot;Category&quot;</span>),</div>
<div class="line">               <span class="stringliteral">&quot;path-to-an-24-by-24-icon-file.png&quot;</span>,</div>
<div class="line">               <span class="stringliteral">&quot;path-to-an-16-by-16-icon-file.png&quot;</span>)</div>
<div class="line">    .AddParameter(<span class="stringliteral">&quot;theTypeOfTheParameter&quot;</span>, _(<span class="stringliteral">&quot;Parameter1&quot;</span>))</div>
<div class="line">    .AddParameter(<span class="stringliteral">&quot;theTypeOfTheParameter&quot;</span>, _(<span class="stringliteral">&quot;Parameter2&quot;</span>))</div>
<div class="line">    .codeExtraInformation.SetFunctionName(<span class="stringliteral">&quot;MyFunctionName&quot;</span>).SetIncludeFile(<span class="stringliteral">&quot;MyExtension/MyIncludeFile.h&quot;</span>);</div>
</div><!-- fragment --><p> Declare conditions and expressions in a similar way.<br/>
 Parameters are added using <a class="el" href="classgd_1_1_instruction_metadata.html#a7d89b891eeaba90c00f99d97eece501b" title="Add a parameter to the instruction ( condition or action ) information class. ">gd::InstructionMetadata::AddParameter</a>.</p>
<p>The last line set the function name that will be called when generating the code of an event using the action:<br/>
 You can either do it after declaring the function, or later using this syntax:</p>
<div class="fragment"><div class="line">GetAllActions()[<span class="stringliteral">&quot;ExtensionName::ActionName&quot;</span>].codeExtraInformation.SetFunctionName(<span class="stringliteral">&quot;MyFunctionName&quot;</span>);</div>
</div><!-- fragment --><p>Both methods are ok, but the latest allows to use the same code to declare an extension for the C++ and JS platform, then customize the names of the functions to call.</p>
<h1><a class="anchor" id="objectsDeclaration"></a>
Declare objects</h1>
<p>Adding an object is made using <a class="el" href="classgd_1_1_platform_extension.html#a49b70f32ba953397f38002d008bdf597" title="Declare a new object as being part of the extension. ">gd::PlatformExtension::AddObject</a> method.</p>
<div class="fragment"><div class="line"><a class="code" href="classgd_1_1_object_metadata.html" title="Contains user-friendly information about an object type. ">gd::ObjectMetadata</a> &amp; obj = AddObject(<span class="stringliteral">&quot;Name&quot;</span>,</div>
<div class="line">                   _(<span class="stringliteral">&quot;Name displayed to users&quot;</span>),</div>
<div class="line">                   _(<span class="stringliteral">&quot;Description&quot;</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;path-to-an-32-by-32-icon.png&quot;</span>,</div>
<div class="line">                   &amp;FunctionForCreatingTheObject,</div>
<div class="line">                   &amp;FunctionForDestroyingTheObject);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Extra function to call for the C++ platform:</span></div>
<div class="line">AddRuntimeObject(obj, <span class="stringliteral">&quot;RuntimeObjectName&quot;</span>, CreateRuntimeObjectName, DestroyRuntimeObjectName);</div>
</div><!-- fragment --><p><em>FunctionForCreatingTheObject</em> and <em>FunctionForDestroyingTheObject</em> are two functions that must be provided with the object, the first one to create an object and the second to delete an object previously created. They are similar to the functions used to create and destroy a platform. They should look just like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> DestroyTextObject(<a class="code" href="classgd_1_1_object.html" title="Base class used to represent an object of a platform. ">gd::Object</a> * <span class="keywordtype">object</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">delete</span> object;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="classgd_1_1_object.html" title="Base class used to represent an object of a platform. ">gd::Object</a> * CreateTextObject(std::string name)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">new</span> TextObject(name);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <em>C++ platform</em> also requires that you call <em>AddRuntimeObject</em> to declares the RuntimeObject class associated to the object being declared:<br/>
 You must pass as parameter the name of the class inheriting from RuntimeObject and two functions used to create and destroy an instance of the RuntimeObject.</p>
<p>You will also want to specify where the object is located using <a class="el" href="classgd_1_1_object_metadata.html#afcea120749f53034c45e13872ce2769b" title="Erase any existing include file and add the specified include. ">gd::ObjectMetadata::SetIncludeFile</a>. For example: </p>
<div class="fragment"><div class="line">obj.<a class="code" href="classgd_1_1_object_metadata.html#afcea120749f53034c45e13872ce2769b" title="Erase any existing include file and add the specified include. ">SetIncludeFile</a>(<span class="stringliteral">&quot;TextObject/TextObject.h&quot;</span>);</div>
</div><!-- fragment --><p>You can then declare the actions, conditions, and expressions related to the objects, using the AddAction/AddCondition/AddExpression methods provided by <em>obj</em>.</p>
<h1><a class="anchor" id="eventsDeclaration"></a>
Declaring events</h1>
<p>Events are declared like this : </p>
<div class="fragment"><div class="line">AddEvent(<span class="stringliteral">&quot;Name&quot;</span>,</div>
<div class="line">              _(<span class="stringliteral">&quot;Name displayed to users&quot;</span>),</div>
<div class="line">              <span class="stringliteral">&quot;Description&quot;</span>,</div>
<div class="line">              <span class="stringliteral">&quot;Group&quot;</span>,</div>
<div class="line">              <span class="stringliteral">&quot;path-to-a-16-by-16-icon.png&quot;</span>,</div>
<div class="line">              boost::shared_ptr&lt;gd::BaseEvent&gt;(<span class="keyword">new</span> EventClassName))</div>
</div><!-- fragment --><p>The event must be able to generate its code when events are being translated to C++ or Javascript:<br/>
 This is done by calling SetCodeGenerator. For example:</p>
<div class="fragment"><div class="line">AddEvent(<span class="stringliteral">&quot;Standard&quot;</span>,</div>
<div class="line">          _(<span class="stringliteral">&quot;Standard event&quot;</span>),</div>
<div class="line">          _(<span class="stringliteral">&quot;Standard event: Actions are run if conditions are fulfilled.&quot;</span>),</div>
<div class="line">          <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">          <span class="stringliteral">&quot;res/eventaddicon.png&quot;</span>,</div>
<div class="line">          boost::shared_ptr&lt;gd::BaseEvent&gt;(<span class="keyword">new</span> <a class="code" href="classgd_1_1_standard_event.html" title="Standard event, with conditions, actions and support for sub events. ">gd::StandardEvent</a>))</div>
<div class="line">          .SetCodeGenerator(boost::shared_ptr&lt;gd::EventMetadata::CodeGenerator&gt;(codeGen));</div>
</div><!-- fragment --><h1><a class="anchor" id="automatismsDeclaration"></a>
Declaring the automatisms</h1>
<p>Automatisms are declared like objects:</p>
<div class="fragment"><div class="line"><a class="code" href="classgd_1_1_automatism_metadata.html" title="Contains user-friendly information about an automatism type. ">gd::AutomatismMetadata</a> &amp; aut = AddAutomatism(<span class="stringliteral">&quot;Name&quot;</span>,</div>
<div class="line">                  _(<span class="stringliteral">&quot;Name displayed to users&quot;</span>),</div>
<div class="line">                  _(<span class="stringliteral">&quot;DefaultNameUsedInEditor&quot;</span>),</div>
<div class="line">                  _(<span class="stringliteral">&quot;Description.&quot;</span>),</div>
<div class="line">                  <span class="stringliteral">&quot;Group&quot;</span>,</div>
<div class="line">                  <span class="stringliteral">&quot;path-to-a-32-by-32-icon.png&quot;</span>,</div>
<div class="line">                  <span class="stringliteral">&quot;AutomatismClassName&quot;</span>,</div>
<div class="line">                  boost::shared_ptr&lt;gd::Automatism&gt;(<span class="keyword">new</span> AutomatismClassName),</div>
<div class="line">                  boost::shared_ptr&lt;gd::AutomatismsSharedData&gt;(<span class="keyword">new</span> AutomatismSharedDataClassName));</div>
</div><!-- fragment --><p> The last line can be replaced by <code>boost::shared_ptr&lt;gd::AutomatismsSharedData&gt;()</code> if no shared data are being used.</p>
<p>You can then declare the actions, conditions, and expressions related to the automatism like objects:<br/>
 Call AddAction/AddCondition/AddExpression on the <em>aut</em> object.</p>
<h1><a class="anchor" id="excludingNonRuntimeDeclaration"></a>
(C++ platform) Excluding elements declaration from runtime</h1>
<p>When your extension is compiled for the C++ platform Runtime, GDevelop does not known anything about action/condition or even events classes.<br/>
 You have then to exclude all actions/conditions/expressions/events declaration from extension at runtime (only Extension/Object/Automatisms declarations have to be kept).</p>
<p>Use the *<code>GD_IDE_ONLY</code> define* to achieve this goal, as demonstrated in this skeleton of a complete extension declaration: </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Extension : <span class="keyword">public</span> ExtensionBase <span class="comment">//For C++ platform, extensions must derive from ExtensionBase</span></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    Extension()</div>
<div class="line">    {</div>
<div class="line">        SetExtensionInformation(<span class="stringliteral">&quot;MyExtension&quot;</span>,</div>
<div class="line">                              _(<span class="stringliteral">&quot;Extension name&quot;</span>),</div>
<div class="line">                              _(<span class="stringliteral">&quot;Extension declaration&quot;</span>),</div>
<div class="line">                              <span class="stringliteral">&quot;Author&quot;</span>,</div>
<div class="line">                              <span class="stringliteral">&quot;license&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #if defined(GD_IDE_ONLY)</span></div>
<div class="line"><span class="preprocessor"></span>        AddAction(...);</div>
<div class="line">        AddCondition(...);</div>
<div class="line">        AddExpression(...);</div>
<div class="line"><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classgd_1_1_object_metadata.html" title="Contains user-friendly information about an object type. ">gd::ObjectMetadata</a> &amp; obj = AddObject(<span class="stringliteral">&quot;ObjectName&quot;</span>,</div>
<div class="line">                       _(<span class="stringliteral">&quot;Object name&quot;</span>),</div>
<div class="line">                       _(<span class="stringliteral">&quot;Description&quot;</span>),</div>
<div class="line">                       <span class="stringliteral">&quot;CppPlatform/Extensions/myicon.png&quot;</span>,</div>
<div class="line">                       &amp;CreateMyObject,</div>
<div class="line">                       &amp;DestroyMyObject,</div>
<div class="line">                       <span class="stringliteral">&quot;ObjectClassName&quot;</span>);</div>
<div class="line"></div>
<div class="line">            AddRuntimeObject(obj, <span class="stringliteral">&quot;RuntimeObjectName&quot;</span>, CreateRuntimeObjectName, DestroyRuntimeObjectName);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #if defined(GD_IDE_ONLY)</span></div>
<div class="line"><span class="preprocessor"></span>            obj.<a class="code" href="classgd_1_1_object_metadata.html#afcea120749f53034c45e13872ce2769b" title="Erase any existing include file and add the specified include. ">SetIncludeFile</a>(<span class="stringliteral">&quot;MyExtension/MyIncludeFile.h&quot;</span>);</div>
<div class="line"></div>
<div class="line">            obj.<a class="code" href="classgd_1_1_object_metadata.html#a00c0bf0273db581bd6104309b7534f1e" title="Declare a new action as being part of the extension. ">AddAction</a>(...);</div>
<div class="line">            obj.<a class="code" href="classgd_1_1_object_metadata.html#aec38f12ad965b073ee12bcdf4c1716c7" title="Declare a new condition as being part of the extension. ">AddCondition</a>(...);</div>
<div class="line">            obj.<a class="code" href="classgd_1_1_object_metadata.html#aa2f317aa43ca77cdefbe5412f53ef4d8" title="Declare a new expression as being part of the extension. ">AddExpression</a>(...);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classgd_1_1_automatism_metadata.html" title="Contains user-friendly information about an automatism type. ">gd::AutomatismMetadata</a> &amp; aut = AddAutomatism(<span class="stringliteral">&quot;AutomatismName&quot;</span>,</div>
<div class="line">                       _(<span class="stringliteral">&quot;Automatism name&quot;</span>),</div>
<div class="line">                       <span class="stringliteral">&quot;defaultGDname&quot;</span>,</div>
<div class="line">                       _(<span class="stringliteral">&quot;Description&quot;</span>),</div>
<div class="line">                       <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                       <span class="stringliteral">&quot;CppPlatform/Extensions/myicon.png&quot;</span>,</div>
<div class="line">                       <span class="stringliteral">&quot;PhysicsAutomatism&quot;</span>,</div>
<div class="line">                       boost::shared_ptr&lt;gd::Automatism&gt;(<span class="keyword">new</span> AutomatismClassName),</div>
<div class="line">                       boost::shared_ptr&lt;gd::AutomatismsSharedData&gt;(<span class="keyword">new</span> AutomatismSharedDataClassName));</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #if defined(GD_IDE_ONLY)</span></div>
<div class="line"><span class="preprocessor"></span>            automatismInfo.SetIncludeFile(<span class="stringliteral">&quot;MyExtension/MyIncludeFile.h&quot;</span>);</div>
<div class="line"></div>
<div class="line">            aut.<a class="code" href="classgd_1_1_automatism_metadata.html#a9d3528a87b59bad548f97ad974032b95">AddAction</a>(...);</div>
<div class="line">            aut.<a class="code" href="classgd_1_1_automatism_metadata.html#abc1efd721c92f4c84c24b2de0dbfe205">AddCondition</a>(...);</div>
<div class="line">            aut.<a class="code" href="classgd_1_1_automatism_metadata.html#ad584bf7a99eb6370748c9c9116bd8741">AddExpression</a>(...);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        GD_COMPLETE_EXTENSION_COMPILATION_INFORMATION();</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">virtual</span> ~Extension() {};</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// Used by GDevelop to create the extension class</span></div>
<div class="line"><span class="comment">// -- Do not need to be modified. --</span></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> ExtensionBase * GD_EXTENSION_API CreateGDExtension() {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">new</span> Extension;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Used by GDevelop to destroy the extension class</span></div>
<div class="line"><span class="comment">// -- Do not need to be modified. --</span></div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> GD_EXTENSION_API DestroyGDExtension(ExtensionBase * p) {</div>
<div class="line">    <span class="keyword">delete</span> p;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 25 2014 20:53:30 for GDevelop Core by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
